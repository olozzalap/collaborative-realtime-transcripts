(this["webpackJsonpcrt-frontend"]=this["webpackJsonpcrt-frontend"]||[]).push([[0],{13:function(e,t,n){e.exports=n(25)},18:function(e,t,n){},23:function(e,t,n){e.exports=n.p+"static/media/times-circle-solid.f2d68558.svg"},25:function(e,t,n){"use strict";n.r(t);var r,a,c,o,l,i=n(0),s=n.n(i),u=n(9),d=n.n(u),v=(n(18),n(2)),m=n(11),p=n(1),h=n.n(p),f=n(3),x=n(4),g=n(5),w=g.a.div(r||(r=Object(x.a)(["\n    cursor: pointer;\n    transition: 300ms;\n    &:hover {\n        background-color: rgba(215, 210, 239, .5);\n    }\n"]))),b=g.a.svg(a||(a=Object(x.a)(["\n    min-width: 16px;\n    max-width: 16px;\n    transition: 300ms;\n    &:hover {\n        color: rgb(224, 45, 109);\n    }\n"]))),E=g.a.svg(c||(c=Object(x.a)(["\n    min-width: 64px;\n    max-width: 64px;\n    padding: 32px 0;\n    transition: 300ms;\n    &:hover {\n        color: rgb(65, 125, 219);\n    }\n"]))),j=function(e){var t=e.author,n=e.setSelectedConversation,r=Object(i.useState)([]),a=Object(v.a)(r,2),c=a[0],o=a[1],l=Object(i.useState)(""),u=Object(v.a)(l,2),d=u[0],p=u[1];Object(i.useEffect)((function(){var e=function(){var e=Object(f.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/conversations");case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(null===c||void 0===c?void 0:c.length)||e()}),[]),console.warn(c);var x=function(){var e=Object(f.a)(h.a.mark((function e(t,n){var r,a,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("\n            deleteConvo\n            "),t.preventDefault(),t.stopPropagation(),e.next=5,fetch("/conversations",{method:"DELETE",body:JSON.stringify({id:n}),headers:{"Content-Type":"application/json"}});case 5:return r=e.sent,e.next=8,r.json();case 8:(null===(a=e.sent)||void 0===a?void 0:a.ok)?(l=c.filter((function(e){return e.id!==n})),o(l)):console.error(null===a||void 0===a?void 0:a.msg);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=Object(f.a)(h.a.mark((function e(){var n,r,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("\n            createConvo\n            "),e.next=3,fetch("/conversations",{method:"POST",body:JSON.stringify({author:t,title:d}),headers:{"Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:(null===(r=e.sent)||void 0===r?void 0:r.ok)?((a=null===r||void 0===r?void 0:r.newConversation).text=null===r||void 0===r?void 0:r.text,a.id=a._id,o([].concat(Object(m.a)(c),[a])),p("")):console.error(null===r||void 0===r?void 0:r.msg);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return s.a.createElement("main",{className:"ConversationList row m-3"},c.map((function(e){var t;return s.a.createElement("div",{className:"col-md-4 col-sm-6 col-12 pb-3"},s.a.createElement(w,{className:"card",onClick:function(){return n(e)}},s.a.createElement("div",{className:"card-body"},s.a.createElement("h3",{className:"card-title d-flex justify-content-between"},s.a.createElement("span",null,e.title),s.a.createElement(b,{onClick:function(t){return x(t,e.id)},focusable:"false","data-prefix":"fas","data-icon":"trash-alt",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},s.a.createElement("path",{fill:"currentColor",d:"M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"}))),s.a.createElement("p",{className:"card-text"},"createdAt: ",new Date(e.createdAt).toLocaleDateString()),s.a.createElement("p",{className:"card-text"},"lastMutationAt: ",new Date(e.lastMutationAt).toLocaleDateString()),s.a.createElement("p",{className:"card-text"},"originState | ",JSON.stringify(null===e||void 0===e?void 0:e.originState)),s.a.createElement("h6",{className:"card-subtitle my-2 text-muted"},'"',null===e||void 0===e||null===(t=e.text)||void 0===t?void 0:t.slice(0,100),'"'))))})),s.a.createElement("div",{className:"col-md-4 col-sm-6 col-12"},s.a.createElement(w,{className:"card"},s.a.createElement("h3",{className:"card-title d-flex justify-content-center"},"New transcript?"),s.a.createElement("label",{className:"card-text d-flex justify-content-around"},"Title:",s.a.createElement("input",{onChange:function(e){return p(e.target.value)},placeholder:"Title",value:d})),s.a.createElement("div",{className:"d-flex justify-content-center"},s.a.createElement(E,{onClick:g,focusable:"false","data-prefix":"fas","data-icon":"plus-circle",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},s.a.createElement("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"}))))))},O=(n(23),0),S=g.a.svg(o||(o=Object(x.a)(["\n    width: 40px;\n    cursor: pointer;\n"]))),C=g.a.textarea(l||(l=Object(x.a)(["\n    margin: 24px;\n    width: 100%;\n    max-width: 800px;\n    height: 360px;\n    max-height: 100%;\n"]))),I=function(e){var t=e.author,n=e.conversation,r=e.setSelectedConversation,a=Object(i.useState)(null===n||void 0===n?void 0:n.text),c=Object(v.a)(a,2),o=c[0],l=c[1],u=Object(i.useState)(JSON.parse(null===n||void 0===n?void 0:n.originState)),d=Object(v.a)(u,2),m=d[0],p=d[1],x=Object(i.useRef)(null===n||void 0===n?void 0:n.text),g=Object(i.useRef)(null),w=Object(i.useRef)(null),b=Object(i.useRef)({cursorIndex:null,isInsert:null,length:0,newText:""}),E=b.current,j=(E.cursorIndex,E.isInsert,E.length,E.newText,function(){var e=Object(f.a)(h.a.mark((function e(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:clearTimeout(w.current),w.current=setTimeout(Object(f.a)(h.a.mark((function e(){var r,a,c,o,l,i,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("\n                debounced post!\n                cursorIndex is: ".concat(b.current.cursorIndex,"\n                mutationState is: \n                ")),console.warn(JSON.stringify(b.current)),(r=new FormData).append("conversationId",null===n||void 0===n?void 0:n.id),r.append("author",t),r.append("index",(b.current.isInsert,b.current.cursorIndex)),r.append("type",b.current.isInsert?"insert":"delete"),r.append("length",b.current.length),r.append("text",b.current.newText),r.append("origin",JSON.stringify(m)),e.next=12,fetch("/mutations",{method:"POST",body:JSON.stringify(Object.fromEntries(r.entries())),headers:{"Content-Type":"application/json"}});case 12:return a=e.sent,e.next=15,a.json();case 15:(null===(c=e.sent)||void 0===c?void 0:c.ok)?(x.current=null===c||void 0===c?void 0:c.text,(null===c||void 0===c?void 0:c.newIndex)!==b.current.cursorIndex&&(s=(null===g||void 0===g||null===(o=g.current)||void 0===o?void 0:o.selectionStart)+((null===c||void 0===c?void 0:c.newIndex)-b.current.cursorIndex),console.warn("\n                        mutationState.current.cursorIndex is: ".concat(b.current.cursorIndex,"\n                        inputRef?.current?.selectionStart is: ").concat(null===g||void 0===g||null===(l=g.current)||void 0===l?void 0:l.selectionStart,"\n                         newCursorIndex is: ").concat(s,"\n                         ")),null===g||void 0===g||null===(i=g.current)||void 0===i||i.setSelectionRange(s,s),b.current={cursorIndex:null,isInsert:null,length:0,newText:""}),p(null===c||void 0===c?void 0:c.origin)):console.error(null===c||void 0===c?void 0:c.msg);case 17:case"end":return e.stop()}}),e)}))),700);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());return O++,console.warn("\n        Render #".concat(O,"\n        apiOrigin is: ").concat(m,"\n    ")),s.a.createElement("div",null,s.a.createElement("div",{className:"d-flex justify-content-around align-items-center"},s.a.createElement("div",null,"Origin: ",JSON.stringify(m)),s.a.createElement("div",{onClick:function(){return r(null)}},s.a.createElement(S,{focusable:"false","data-prefix":"fas","data-icon":"times-circle",className:"text-warning",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},s.a.createElement("path",{fill:"currentColor",d:"M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"})))),s.a.createElement("div",{className:"d-flex justify-content-center"},s.a.createElement(C,{"aria-label":"Conversation Editor",class:"p-2",placeholder:"Conversation Editor",onChange:function(e){var t,n,r,a=e.target.value,c=a.length>x.current.length;b.current.cursorIndex||(b.current.cursorIndex=c?(null===e||void 0===e||null===(n=e.target)||void 0===n?void 0:n.selectionStart)-1:null===e||void 0===e||null===(r=e.target)||void 0===r?void 0:r.selectionEnd,console.warn("\n                set mutationState.current.cursorIndex is: ".concat(b.current.cursorIndex,"\n                ")));console.warn("\n            handleChange\n            value is: ".concat(a,"\n            apiConvoText.current.length is: ").concat(x.current.length,"\n            e?.target?.selectionStart is: ").concat(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.selectionStart,"\n            cursorIndex is: ").concat(b.current.cursorIndex,"\n            newMutationIsInsert is: ").concat(c,"\n            value.length - apiConvoText.current.length is: ").concat(a.length-x.current.length,"\n        ")),c?(b.current.isInsert=!0,b.current.length=a.length-x.current.length,b.current.newText=a.slice(b.current.cursorIndex,b.current.cursorIndex+b.current.length)):(b.current.isInsert=!1,b.current.length=x.current.length-a.length,b.current.newText=""),l(a),j()},ref:g,type:"text",value:o})))},y=function(e){var t=e.author,n=e.setAuthor,r=Object(i.useState)(t),a=Object(v.a)(r,2),c=a[0],o=a[1];return s.a.createElement("header",{className:"bg-secondary text-white d-flex align-items-center justify-content-around"},s.a.createElement("div",{className:"d-flex align-items-center p-2"},s.a.createElement("label",null,"Author:"),s.a.createElement("input",{"aria-label":"Author",class:"form-control mx-2",placeholder:"Author",onChange:function(e){var t;return o(null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)},type:"text",value:c}),s.a.createElement("button",{type:"button",class:"btn btn-success",onClick:n(c)},"Update")),s.a.createElement("h1",{className:"p-2"},"C.R.T. \ud83d\udcfa"))},N=["Bob","Alice"],T=function(){var e=Object(i.useState)(N[Math.floor(Math.random()*N.length)]),t=Object(v.a)(e,2),n=t[0],r=t[1],a=Object(i.useState)(null),c=Object(v.a)(a,2),o=c[0],l=c[1];return s.a.createElement("main",{id:"CRTPage"},s.a.createElement(y,{author:n,setAuthor:r}),o?s.a.createElement(I,{author:n,conversation:o,setSelectedConversation:l}):s.a.createElement(j,{author:n,setSelectedConversation:l}))},k=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,26)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};n(24);d.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(T,null)),document.getElementById("root")),k()}},[[13,1,2]]]);
//# sourceMappingURL=main.87fab02e.chunk.js.map